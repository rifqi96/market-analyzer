# Market Analysis Tool

A comprehensive market analysis tool that provides data-driven insights and forecasts based on technical indicators and market patterns for cryptocurrency, stock, forex, and commodity markets.

## Overview

This project implements a modular framework for technical market analysis, focusing on:

- Multi-market support (cryptocurrency, stocks, forex, commodities)
- Multi-timeframe analysis (1h, 4h, 1d, 3d, 1w)
- Key technical indicators (Moving averages, RSI, MACD, Bollinger Bands, etc.)
- Support and resistance level identification
- Trend and momentum analysis
- Short-term and monthly price forecasts
- Visualization of price data and indicators
- Comprehensive analysis reports

## Features

- **Data Fetching**: Retrieve market data from multiple sources (Binance, CoinGecko, Yahoo Finance, Alpha Vantage)
- **Technical Analysis**: Calculate various technical indicators and identify market patterns
- **Forecast Generation**: Create probability-based price forecasts for different timeframes
- **Visualization**: Generate charts with price data and indicator overlays
- **Reporting**: Create comprehensive analysis reports with insights and forecasts
- **Caching**: Intelligent caching system for improved performance and reduced API calls
- **Multi-Market Support**: Analysis of cryptocurrencies, stocks, forex pairs, and commodities
- **Rate Limit Handling**: Exponential backoff strategy for handling API rate limits
- **Historical Analysis**: Analyze markets as they were on any past date for backtesting and research

## Directory Structure

```sh
/market-analyzer/
├── market_analyzer/
│   ├── __init__.py
│   ├── config.py            # Configuration settings
│   ├── data_fetcher.py      # Data retrieval module
│   ├── indicators.py        # Technical indicator calculation
│   ├── analyzer.py          # Analysis and forecast generation
│   ├── visualizer.py        # Chart generation
│   └── reporter.py          # Report generation
├── output/
│   ├── cryptocurrency/      # Crypto market output
│   ├── stock/               # Stock market output
│   ├── forex/               # Forex market output
│   └── commodity/           # Commodity market output
├── memory-bank/             # Project memory bank
├── requirements.txt         # Python dependencies
├── run_analysis.py          # Main execution script
├── analyze_gold.py          # Gold analysis script
├── analyze_gold_futures.py  # Gold futures analysis script
├── test_commodity.py        # Commodity test script
└── README.md                # Project documentation
```

## Installation

1. Clone the repository:

   ```sh
   git clone https://github.com/your-username/market-analyzer.git
   cd market-analyzer
   ```

2. Install dependencies:

   ```sh
   pip install -r requirements.txt
   ```

## Usage

Run the main analysis script:

```sh
python run_analysis.py BTCUSDT --market-type cryptocurrency
```

### Command-Line Options

- `trading_pair`: Trading pair to analyze (e.g., `BTCUSDT`, `AAPL`, `EURUSD`, `XAUUSD`)
- `--market-type`: Select market type (`cryptocurrency`, `stock`, `forex`, or `commodity`)
- `--timeframes`: Specify timeframes to analyze (e.g., `--timeframes 1h 4h 1d`)
- `--source`: Select data source (`binance`, `coingecko`, `yahoo_finance`, or `alpha_vantage`)
- `--reports`: Choose reports to generate (`short`, `monthly`, `combined`, or `all`)
- `--no-charts`: Disable chart generation (charts are generated by default)
- `--output-dir`: Specify custom output directory
- `--analysis-date`: Analyze the market as it was on a specific date (format: `YYYY-MM-DD`)

Example:

```sh
python run_analysis.py AAPL --market-type stock --timeframes 1h 1d --source yahoo_finance --reports all
```

For commodity analysis:

```sh
python run_analysis.py XAUUSD --market-type commodity --source alpha_vantage
```

or using futures symbols:

```sh
python run_analysis.py GC=F --market-type commodity --source yahoo_finance
```

### Historical Analysis

Analyze the market as it was on a specific past date:

```sh
# Analyze Bitcoin as it was on May 1, 2025
python run_analysis.py BTCUSDT --market-type cryptocurrency --analysis-date 2025-05-01

# Analyze Apple stock from 30 days ago
python run_analysis.py AAPL --market-type stock --analysis-date 2025-04-25

# Compare past predictions with actual outcomes
python run_analysis.py EURUSD --market-type forex --analysis-date 2025-04-15 --reports all
```

This feature is useful for:
- Backtesting analysis accuracy
- Understanding historical market conditions
- Comparing past forecasts with actual price movements
- Studying market behavior at specific dates

## Output

The analysis generates the following outputs:

### Charts

- Price charts with moving averages
- Bollinger Bands visualization
- RSI (Relative Strength Index) charts
- MACD (Moving Average Convergence Divergence) charts
- Comprehensive charts combining price data with key indicators

### Reports

- Short-term forecast (1-week)
- Monthly forecast (through end of 2025)
- Combined comprehensive analysis

## Documentation

- [Multi-Market Analysis Plan](market-data-analysis-plan.md) - Detailed plan for data sources, analysis methods, and implementation strategy across different markets.

## Dependencies

- pandas: Data manipulation and analysis
- numpy: Numerical operations
- matplotlib: Data visualization
- seaborn: Enhanced visualizations
- requests: HTTP requests for API interaction
- plotly: Interactive visualizations

## Market-Specific Features

### Cryptocurrency

- Data sources: Binance API and CoinGecko API
- Optimized for high volatility environments
- Support for any trading pair

### Stocks

- Data source: Yahoo Finance API
- Adjusted parameters for stock market behavior
- Volume analysis with spike filtering

### Forex

- Data sources: Alpha Vantage API and Yahoo Finance API
- Specialized parameters for lower volatility markets
- Optimized support/resistance detection

### Commodities

- Data sources: Yahoo Finance API and Alpha Vantage API
- Support for precious metals (Gold, Silver) and energy commodities (Oil, Natural Gas)
- Compatible with futures contracts (GC=F, SI=F, CL=F) and ETFs (GLD, SLV)
- Automatic price formatting with appropriate currency symbols
- Optimized parameters for medium-to-high volatility markets

## Handling API Rate Limits

This tool integrates with multiple external APIs, many of which enforce rate limits. Here's how to handle potential rate limiting issues:

### Common Rate Limit Challenges

- **Yahoo Finance**: Unofficial API with unpredictable rate limits (typically 2000 requests per hour)
- **Alpha Vantage**: Free tier limited to 5 requests per minute, 500 requests per day
- **CoinGecko**: 50 requests per minute
- **Binance**: 1200 requests per minute per IP (weight-based system)

### Built-in Solutions

1. **Caching System**: The tool automatically caches API responses based on timeframe to reduce repeated requests
2. **Exponential Backoff**: Implements retry logic with exponential backoff for rate-limited requests
3. **Alternative Sources**: Automatically tries alternative data sources when primary source fails
4. **Configurable Options**: Allows selecting specific timeframes to reduce the number of API calls

### Workarounds for Rate Limits

If you're experiencing rate limit issues:

1. **Use Cached Data**: The system will use cached data when available. Try running the analysis once, then run it again after a short wait.

2. **Reduce Analysis Scope**: Limit the number of timeframes analyzed:

   ```sh
   # Analyze only daily timeframe
   python run_analysis.py XAUUSD --market-type commodity --timeframes 1d
   ```

3. **Use Alpha Vantage API Key**: For stocks, forex, and some commodities, you can set your Alpha Vantage API key:

   ```sh
   export ALPHA_VANTAGE_API_KEY='your_api_key'
   ```

4. **Stagger Analysis**: When analyzing multiple assets, wait a few minutes between runs.

5. **Use Helper Scripts**: Use specialized scripts that focus on specific assets:

   ```sh
   python analyze_gold.py
   ```

## License

MIT

## Disclaimer

This tool provides technical analysis and forecasts based on historical data and technical indicators. It is for informational purposes only and should not be considered financial advice. Markets are highly volatile and unpredictable. Past performance is not indicative of future results. Always conduct your own research and consider your risk tolerance before making investment decisions.
